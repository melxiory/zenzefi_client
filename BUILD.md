# Инструкция по сборке ZenzefiClient

## Быстрая сборка (рекомендуется)

```bash
python build_optimized.py
```

Этот скрипт автоматически:
- Очищает предыдущие сборки
- Оптимизирует байткод (уровень 2)
- Собирает приложение с максимальной оптимизацией
- Выводит статистику размера файла

## Ручная сборка

```bash
# Очистка предыдущих сборок
pyinstaller --clean --noconfirm ZenzefiClient.spec
```

## Результат

Исполняемый файл будет находиться в:
```
dist/ZenzefiClient.exe
```

## Оптимизации в ZenzefiClient.spec

### 1. Исключения модулей (уменьшение ~20-30%)
- Исключены неиспользуемые библиотеки: tkinter, matplotlib, numpy, pandas, etc.
- Исключены тестовые фреймворки: unittest, pytest
- Исключены инструменты разработки: setuptools, distutils

### 2. UPX компрессия (уменьшение ~30-50%)
- Включено: `upx=True`
- Исключены критичные DLL от сжатия: vcruntime140.dll, python313.dll, Qt DLL

### 3. Strip отладочной информации
- Отключено на Windows: `strip=False`
- Strip требует GNU binutils (Unix-утилита), не доступна на Windows
- UPX компенсирует отсутствие strip

### 4. Оптимизация байткода
- Компиляция с `-OO` (удаление docstrings и assert)
- Минимизация .pyc файлов

## Ожидаемый размер

**До оптимизаций:** ~80-120 МБ
**После оптимизаций:** ~30-50 МБ

**Экономия:** ~50-60% от исходного размера

## Требования

- Python 3.13
- PyInstaller (`pip install pyinstaller`)
- UPX (опционально, для максимального сжатия)
  - Скачать: https://upx.github.io/
  - Добавить в PATH или положить upx.exe в папку проекта

## Проверка сборки

```bash
# Запуск собранного приложения
dist\ZenzefiClient.exe
```

## Troubleshooting

### UPX не найден
```bash
# Отключить UPX в ZenzefiClient.spec
upx=False
```

### Ошибка при запуске .exe
```bash
# Пересобрать с консолью для отладки
# В ZenzefiClient.spec: console=True
```

### Большой размер файла
1. Убедитесь что UPX установлен и доступен
2. Убедитесь что `upx=True` в spec файле
3. Добавьте дополнительные модули в `excludes`

### Предупреждения "Failed to run strip"
- Это нормально для Windows - strip это Unix-утилита
- Предупреждение не влияет на работу приложения
- UPX компенсирует отсутствие strip сжатием